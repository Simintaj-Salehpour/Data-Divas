---
title: "Mid-term Project"
author: "Simintaj Salehpour, Madeline Bumpus, Nazish Atta, Divya Mistry"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(skimr)
library(ggplot2)
library(naniar)
```

### Examining the Relationship Between Demographics, Admission Types, and Clinical Outcomes in New York Inpatients (Niagara County)

## 1. Introduction

**Due:** October 22nd (Wednesday, End of Day)

This R Markdown performs an exploratory data analysis (EDA) for the dataset `Hospital_Inpatient_Discharges.csv`. It contains code, explanation, dataset summary, descriptive statistics, graphical displays, variance/SD measures, normality checks, and initial statistical tests. 

## 2. Load dataset
```{r Load Dataset, include=T, results='markup'}
# Load CSV file
data <- read.csv("Hospital_Inpatient_Discharges.csv")

#Clean column names to avoid backticks

names(data) <- make.names(names(data))

cat("Dataset dimensions: Rows:", nrow(data), "Columns:", ncol(data), "\n")
glimpse(data)

```

## 3. Handle missing value

Here I check if there is a missing value or not. For each column check the missing value.

```{r Missing Value, include=T, results = "markup"}

# --- 1. Summary of missing values ---
missing_summary <- data %>% summarise(across(everything(), ~sum(is.na(.)))) %>%
  pivot_longer(everything(), names_to = "column(variable)", values_to = "n_missing") %>% arrange(desc(n_missing))

missing_summary

# --- 2. Visualize missingness per column ---
gg_miss_var(data) + labs(title = "CVariables VS Number of Missing Values") +
  theme( plot.title = element_text(face = "bold", color = "darkblue"))

# --- 3. Check if there are any missing values ---
clean_data <- data
if(any(is.na(data))) {
  
  cat("Missing values detected!\n")
  total_missing <- sum(is.na(data))
  total_cells <- nrow(data) * ncol(data)
  
  # Remove rows if missing values are few (<5% of total data)
  if(total_missing / total_cells < 0.05) {
    clean_data <- na.omit(data)
    cat("Rows with missing values removed.\n")
  } 
  else {
    # Impute numeric columns with median
    for(col in names(clean_data)) {
      if(is.numeric(clean_data[[col]])) {          # Check if the column is numeric
          clean_data[[col]][is.na(clean_data[[col]])] <- median(clean_data[[col]], na.rm = TRUE)  
      }
    }
    cat("Missing values in numeric columns replaced with median.\n")
  }
  
} else {
  cat("No missing values detected. Dataset is clean.\n")
}


```

## 4. Remove Duplicates
Here I check to remove duplicates:
```{r Remove Duplicates, include=T, results = "markup"}
dup_count <- sum(duplicated(clean_data))
cat("Number of duplicate rows:", dup_count, "\n")

# Remove duplicates
clean_data <- clean_data %>% distinct()
```

## 5. Descriptive statistics

```{r descriptive-stats, include=T, results = "markup"}
# For numeric columns
cat("Numeric Columns summary:")
num_vars <- clean_data %>% select(where(is.numeric))
skim(num_vars)


# Categorical Columns Summary (top counts for first 5 columns)
cat_vars <- clean_data %>% select(where(~!is.numeric(.)))
cols_to_show <- names(cat_vars)[1:min(5, ncol(cat_vars))]

cat("Categorical Columns Summary (first", length(cols_to_show), "columns):\n\n")

for(col in cols_to_show) {
  cat("Column:", col, "\n")
  counts <- sort(table(cat_vars[[col]]), decreasing = TRUE)
  print(head(counts, 6))  # top 6 categories
  cat("\n")
}

```




end